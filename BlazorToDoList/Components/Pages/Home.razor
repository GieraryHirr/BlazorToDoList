@page "/"
@using Microsoft.AspNetCore.Authorization
@using BlazorToDoList.Enums
@attribute [Authorize(Policy = "AuthenticatedUser")]

<PageTitle>Home</PageTitle>

@if (_md5 != null)
{
    <h3>MD5 - @_md5</h3>
}
@if (_sha256 != null)
{
    <h3>SHA256 - @_sha256</h3>
}

@if (_hmac256 != null)
{
    <h3>HMAC256 - @_hmac256</h3>
}
@if (_pbkf2 != null)
{
    <h3>PBKBF2 - @_pbkf2</h3>
}

@if (_bcryptHashed != null)
{
    <h3>BCrypt - @_bcryptHashed</h3>
}

@if (_bcryptVerified != null)
{
    <h3>BCrypt verification - @_bcryptVerified</h3>
}

Welcome to your new app.

@code {
    private string? _md5;
    private string? _sha256;
    private string? _hmac256;
    private string? _pbkf2;
    private string? _bcryptHashed;
    private bool? _bcryptVerified;


    protected override void OnInitialized()
    {
        Codes.HashingHandler hh = new("H1 Oskar");
        _md5 = hh.Md5Hashing(HashFormat.Base64);
        _sha256 = hh.Sha256Hashing(HashFormat.Utf);
        _hmac256 = hh.Hmac256Hashing(HashFormat.Hex);
        _pbkf2 = hh.Pbkbf2Hashing("Salt", "SHA256", HashFormat.ByteString);
        _bcryptHashed = Codes.HashingHandler.BCryptHashing("H1 Oskar");
        _bcryptVerified = Codes.HashingHandler.BCryptVerify("H1 Oskar", _bcryptHashed);
    }
}
